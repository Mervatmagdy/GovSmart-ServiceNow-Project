<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_cb_design_topic">
    <sys_cb_design_topic action="INSERT_OR_UPDATE">
        <compiled_topic display_value="_PRVW__e7e2fbd72b4741c88fadae707b9a2a7e">1bfa0716838a7a9078c11a30ceaad33c</compiled_topic>
        <design_definition>{"type":"FlowTopic","triggers":[{"type":"Trigger","name":"6559da6afbd447febc60359357fcbdd5","triggerType":"request","applicability":{"type":"Applicability","mode":"script","value":"true"},"id":"6559da6afbd447febc60359357fcbdd5"}],"goals":[{"name":"primary","trigger_id":"6559da6afbd447febc60359357fcbdd5","nodes":[{"type":"StartGoal","goal_id":"primary","greeting_msg":{"type":"String","mode":"string","value":"gs.getMessageLang(\"OK {0} Lets Start !\", vaContext.getRequesterLang(), [vaInputs.user.first_name.getDisplayValue()])"},"id":"0a5ce23a788e4525a4d3abc657122582","name":"Start","expert_mode":false},{"type":"TerminateGoal","goal_id":"primary","confirmation_msg":{"type":"String","mode":"string","value":""},"id":"55f03252788a457aaded9d34ff5e7e88","name":"End","expert_mode":false},{"type":"InputPrompt","variable_id":"9b6c4245c10643e98829308fb06f6a4c","message":{"type":"String","mode":"string","value":"gs.getMessageLang(\"gggg\", vaContext.getRequesterLang())"},"nlu_entity_binding":{"type":"NLUEntityBinding","allow_text_input":false,"use_confirmation_prompt":true},"request_feedback":true,"skippable":{"type":"Applicability","mode":"script","value":"false"},"skipreprompt":{"type":"Applicability","mode":"script","value":"false"},"metadataScript":"","cardName":"","cardFields":[],"id":"fd9927611cde4a37ba1d9d658f478f7b","name":"ggg","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"},"expert_mode":false,"formatType":"Custom","validationScript":"function validate(value) {\n    // Trim spaces\n    value = value.trim();\n\n    // Regex for GOV request number (e.g. GOV0001251)\n    var pattern = /^GOV\\d{7}$/;\n\n    var isValid = pattern.test(value);\n\n    return {\n        valid: isValid,\n        error: isValid ? undefined : \"Please enter a valid Request Number (e.g. GOV0001251).\"\n    };\n}\n\n(function execute() {\n    // 1. Get the validated input from the previous node\n    // Replace 'request_number' with the actual Variable Name of your input node\n    var reqNumber = vaInputs.request_number.toString().trim();\n\n    // 2. Query your CUSTOM table (using the Scoped Name from your screenshots)\n    var gr = new GlideRecord('x_1850706_govsma_0_government_service_request'); \n    gr.addQuery('number', reqNumber); // Ensure 'number' is the field name; if it's 'u_number', update it.\n    gr.query();\n\n    if (!gr.next()) {\n        return \"‚ùå No request found with number: \" + reqNumber;\n    }\n\n    // 3. Read values using your table's specific fields\n    var state = gr.getValue('status'); // Your table uses 'status', not 'state'\n    var assignedTo = gr.getDisplayValue('assigned_to');\n    var serviceType = gr.getDisplayValue('service_type');\n\n    // 4. Build response message\n    var message = \"üìÑ **Request Details**\\n\";\n    message += \"üî¢ **Number:** \" + reqNumber + \"\\n\";\n    message += \"üõ†Ô∏è **Service:** \" + serviceType + \"\\n\";\n\n    // Map your \"Status\" values to user-friendly emojis\n    switch (state) {\n        case 'requested':\n            message += \"üïí **Status:** Requested\\nYour request has been received and is waiting for a reviewer.\";\n            break;\n        case 'assigned':\n            message += \"üîç **Status:** Assigned\\nA reviewer is currently looking at your documents.\";\n            break;\n        case 'Approved':\n            message += \"‚úÖ **Status:** Approved\\nYour documents are valid! A Visit Ticket will be issued.\";\n            break;\n        case 'Waiting for User':\n            message += \"‚ö†Ô∏è **Action Required**\\nYour request needs updates. Please check your email for missing documents.\";\n            break;\n        default:\n            message += \"‚ÑπÔ∏è **Current Status:** \" + state;\n    }\n\n    if (assignedTo) {\n        message += \"\\nüë§ **Reviewer:** \" + assignedTo;\n    }\n\n    return message;\n})();\n","description":""}],"edges":[{"type":"Edge","source_node_id":"0a5ce23a788e4525a4d3abc657122582","target_node_id":"fd9927611cde4a37ba1d9d658f478f7b","id":"2d083a51ee564709a6dc3dda2176b59d"},{"type":"Edge","source_node_id":"fd9927611cde4a37ba1d9d658f478f7b","target_node_id":"55f03252788a457aaded9d34ff5e7e88","id":"5ac1af9512be4d9084e2b0e02c07fb9f"}],"id":"primary"}],"script_variables":[],"glide_variables":[{"type":"Reference","table":"sys_user","auto_select":false,"id":"current-user","name":"user","formatType":"text","secure":false,"sensitive":false,"aiInput":false,"list":false},{"type":"String","name":"ggg","list":false,"id":"9b6c4245c10643e98829308fb06f6a4c","formatType":"Custom","validationScript":"function validate(value) {\n    // Trim spaces\n    value = value.trim();\n\n    // Regex for GOV request number (e.g. GOV0001251)\n    var pattern = /^GOV\\d{7}$/;\n\n    var isValid = pattern.test(value);\n\n    return {\n        valid: isValid,\n        error: isValid ? undefined : \"Please enter a valid Request Number (e.g. GOV0001251).\"\n    };\n}\n\n(function execute() {\n    // 1. Get the validated input from the previous node\n    // Replace 'request_number' with the actual Variable Name of your input node\n    var reqNumber = vaInputs.request_number.toString().trim();\n\n    // 2. Query your CUSTOM table (using the Scoped Name from your screenshots)\n    var gr = new GlideRecord('x_1850706_govsma_0_government_service_request'); \n    gr.addQuery('number', reqNumber); // Ensure 'number' is the field name; if it's 'u_number', update it.\n    gr.query();\n\n    if (!gr.next()) {\n        return \"‚ùå No request found with number: \" + reqNumber;\n    }\n\n    // 3. Read values using your table's specific fields\n    var state = gr.getValue('status'); // Your table uses 'status', not 'state'\n    var assignedTo = gr.getDisplayValue('assigned_to');\n    var serviceType = gr.getDisplayValue('service_type');\n\n    // 4. Build response message\n    var message = \"üìÑ **Request Details**\\n\";\n    message += \"üî¢ **Number:** \" + reqNumber + \"\\n\";\n    message += \"üõ†Ô∏è **Service:** \" + serviceType + \"\\n\";\n\n    // Map your \"Status\" values to user-friendly emojis\n    switch (state) {\n        case 'requested':\n            message += \"üïí **Status:** Requested\\nYour request has been received and is waiting for a reviewer.\";\n            break;\n        case 'assigned':\n            message += \"üîç **Status:** Assigned\\nA reviewer is currently looking at your documents.\";\n            break;\n        case 'Approved':\n            message += \"‚úÖ **Status:** Approved\\nYour documents are valid! A Visit Ticket will be issued.\";\n            break;\n        case 'Waiting for User':\n            message += \"‚ö†Ô∏è **Action Required**\\nYour request needs updates. Please check your email for missing documents.\";\n            break;\n        default:\n            message += \"‚ÑπÔ∏è **Current Status:** \" + state;\n    }\n\n    if (assignedTo) {\n        message += \"\\nüë§ **Reviewer:** \" + assignedTo;\n    }\n\n    return message;\n})();\n","secure":false,"sensitive":false,"aiInput":false}],"applicability":{"type":"Applicability","mode":"script","value":"true"},"roles":[],"scope":"e0e99de183fdf21078c11a30ceaad3e5","library-usage":{"type":"Library","input-parameters":[],"return-values-mapping":[]},"domain":"global","topic_type":"TOPIC_BLOCK","channels":[],"dialog_acts_enabled":false,"id":"c847838a83bd3a1078c11a30ceaad303","name":"_PRVW__e7e2fbd72b4741c88fadae707b9a2a7e","key_phrases":[],"nlu_provider":"","nlu_model":"","nlu_model_label":"","nlu_intent":"","nlu_intent_label":"","flexible_conversation_switching":true,"autopilot_topic":false,"design_categories":[{"name":null,"visible":false,"sysId":"3efd22da0b203300a1b16c2367673a10"},{"name":null,"visible":false,"sysId":"a5ce18a1536b101024faddeeff7b12bb"},{"name":null,"visible":false,"sysId":"0a9d30bdebc31110add0ddde23522847"},{"name":null,"visible":false,"sysId":"059dcf85d8675010fa9b0745d3ebb71b"},{"name":null,"visible":false,"sysId":"bfdd66da0b203300a1b16c2367673a1f"}],"triggerable_by_notification":false,"model_type":"nlu_keyword","foundational":false,"modify_confirmation_enabled":false,"context_profiles":[],"title":"Request Status Tracker","library":true,"csTopicId":"8be7c38e83bd3a1078c11a30ceaad342","readOnly":false,"nluMapping":"[]"}</design_definition>
        <design_topic_id>c847838a83bd3a1078c11a30ceaad303</design_topic_id>
        <graph>{
  "graph_api_version": "1.0.82",
  "goals": {
    "primary": {
      "id": "primary",
      "trigger": {
        "type": "primary"
      },
      "name": "primary",
      "applicability": "",
      "description": "",
      "nodes": {
        "0a5ce23a788e4525a4d3abc657122582": {
          "id": "0a5ce23a788e4525a4d3abc657122582",
          "stepType": "Start",
          "name": "Start",
          "greetingResponse": {
            "value": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "text": "OK "
                  },
                  {
                    "type": "datapill",
                    "dataPill": {
                      "value": "{{vaInputs.user.first_name}}",
                      "displayValue": "Input Variables‚ûõUser‚ûõFirst name"
                    },
                    "children": [
                      {
                        "text": ""
                      }
                    ]
                  },
                  {
                    "text": " Lets Start !"
                  }
                ]
              }
            ],
            "mode": "simple"
          }
        },
        "55f03252788a457aaded9d34ff5e7e88": {
          "id": "55f03252788a457aaded9d34ff5e7e88",
          "stepType": "TerminateGoal",
          "name": "End",
          "confirmationMessage": {
            "mode": "simple",
            "value": ""
          }
        },
        "fd9927611cde4a37ba1d9d658f478f7b": {
          "id": "fd9927611cde4a37ba1d9d658f478f7b",
          "stepType": "TextPrompt",
          "name": "ggg",
          "prompt": {
            "value": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "text": "gggg"
                  }
                ]
              }
            ],
            "mode": "simple"
          },
          "confirmMessage": {
            "value": "",
            "mode": "simple"
          },
          "acknowledgeMsg": {
            "value": "",
            "mode": "simple"
          },
          "applicability": {
            "value": "",
            "mode": "query"
          },
          "skippable": {
            "value": "",
            "mode": "query"
          },
          "skipReprompt": {
            "value": "",
            "mode": "query"
          },
          "defaultValue": {
            "value": "",
            "mode": "simple"
          },
          "hasCardHeader": false,
          "cardMetadata": {
            "mode": "card",
            "metadataScript": "",
            "cardTemplate": "",
            "cardFields": {},
            "cardDefinition": {}
          },
          "withNluUserInput": false,
          "skipIfFulfilled": false,
          "variableId": "9b6c4245c10643e98829308fb06f6a4c",
          "detailDescription": "",
          "inputType": {
            "format": "Custom",
            "script": "function validate(value) {\n    // Trim spaces\n    value = value.trim();\n\n    // Regex for GOV request number (e.g. GOV0001251)\n    var pattern = /^GOV\\d{7}$/;\n\n    var isValid = pattern.test(value);\n\n    return {\n        valid: isValid,\n        error: isValid ? undefined : \"Please enter a valid Request Number (e.g. GOV0001251).\"\n    };\n}\n\n(function execute() {\n\n    // Get user input\n    var reqNumber = vaInputs.request_number + \"\";\n\n    // 1Ô∏è‚É£ Validate format (GOV or EMP followed by 7 digits)\n    var pattern = /^(GOV|EMP)\\d{7}$/;\n\n    if (!pattern.test(reqNumber)) {\n        return \"‚ùå Invalid request number format.\\nPlease enter a valid number like: GOV0001251\";\n    }\n\n    // 2Ô∏è‚É£ Query Reviewer Employee table\n    var gr = new GlideRecord('u_reviewer_employee'); // update if your table name is different\n    gr.addQuery('number', reqNumber);\n    gr.query();\n\n    if (!gr.next()) {\n        return \"‚ùå No request found with number: \" + reqNumber;\n    }\n\n    // 3Ô∏è‚É£ Read values\n    var state = gr.getValue('state');\n    var workNotes = gr.getValue('work_notes');\n    var assignedTo = gr.getDisplayValue('assigned_to');\n\n    // 4Ô∏è‚É£ Build response message\n    var message = \"üìÑ **Request Number:** \" + reqNumber + \"\\n\";\n\n    switch (state) {\n\n        case 'New':\n            message += \"üïí **Status:** New\\nYour request has been received and is waiting to be reviewed.\";\n            break;\n\n        case 'In Review':\n            message += \"üîç **Status:** In Review\\nYour request is currently being reviewed by our team.\";\n            break;\n\n        case 'Awaiting User Update':\n            message += \"‚ö†Ô∏è **Action Required**\\n\";\n            message += \"Your request needs additional information.\\n\";\n            message += \"üìù **Reviewer Notes:**\\n\";\n            message += workNotes ? workNotes : \"No notes provided.\";\n            break;\n\n        case 'Approved':\n        case 'Completed':\n            message += \"‚úÖ **Status:** Completed\\nYour request has been successfully completed.\";\n            break;\n\n        case 'Rejected':\n            message += \"‚ùå **Status:** Rejected\\nPlease review the comments and submit again.\";\n            break;\n\n        default:\n            message += \"‚ÑπÔ∏è **Current Status:** \" + state;\n    }\n\n    if (assignedTo) {\n        message += \"\\nüë§ **Assigned Reviewer:** \" + assignedTo;\n    }\n\n    return message;\n\n})();\n\n"
          },
          "requestFeedback": true
        }
      },
      "edges": [
        {
          "id": "2d083a51ee564709a6dc3dda2176b59d",
          "edgeType": "Edge",
          "source": "0a5ce23a788e4525a4d3abc657122582",
          "target": "fd9927611cde4a37ba1d9d658f478f7b",
          "sourcePort": "",
          "targetPort": ""
        },
        {
          "id": "5ac1af9512be4d9084e2b0e02c07fb9f",
          "edgeType": "Edge",
          "source": "fd9927611cde4a37ba1d9d658f478f7b",
          "target": "55f03252788a457aaded9d34ff5e7e88",
          "sourcePort": "",
          "targetPort": ""
        }
      ]
    }
  },
  "variables": {
    "current-user": {
      "category": "vaInputs",
      "id": "current-user",
      "label": "User",
      "name": "user",
      "table": "sys_user",
      "varType": "reference"
    },
    "9b6c4245c10643e98829308fb06f6a4c": {
      "id": "9b6c4245c10643e98829308fb06f6a4c",
      "name": "ggg",
      "label": "Ggg",
      "varType": "string",
      "secure": false,
      "category": "vaInputs",
      "encryptionHashFunction": "SHA-256",
      "encryptionSalt": {
        "value": "MTc2Njk0MjYwOTI4NCBWQSBEZXNpZ25lciBpcyBhd2Vzb21l",
        "mode": "simple"
      },
      "nodeId": "fd9927611cde4a37ba1d9d658f478f7b",
      "isHidden": false
    }
  }
}</graph>
        <name>_PRVW__e7e2fbd72b4741c88fadae707b9a2a7e</name>
        <sys_class_name>sys_cb_design_topic</sys_class_name>
        <sys_created_by>menna.admin</sys_created_by>
        <sys_created_on>2025-12-28 17:39:55</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_id>53fa0716838a7a9078c11a30ceaad342</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>FlowTopic</sys_name>
        <sys_package display_value="GovSmart Review &amp;amp; Visit Management System" source="x_1850706_govsma_0">e0e99de183fdf21078c11a30ceaad3e5</sys_package>
        <sys_policy/>
        <sys_scope display_value="GovSmart Review &amp;amp; Visit Management System">e0e99de183fdf21078c11a30ceaad3e5</sys_scope>
        <sys_update_name>sys_cb_design_topic_53fa0716838a7a9078c11a30ceaad342</sys_update_name>
        <sys_updated_by>menna.admin</sys_updated_by>
        <sys_updated_on>2025-12-28 17:39:55</sys_updated_on>
        <type>FlowTopic</type>
    </sys_cb_design_topic>
</record_update>
